# SPM1D 桌面分析软件

一维统计参数映射(SPM)分析封装软件，无需编程基础，可直接使用！

## 功能特点

- 📁 **数据导入**: 支持CSV/XLSX格式，文件夹结构自动识别指标和组别
- 📈 **正态性检验**: 继承spm1d项目的D'Agostino-Pearson K²检验规则
- 🔬 **多种分析**: 支持t检验、ANOVA、回归分析等
- 📊 **可视化**: 均值曲线图、SPM统计曲线图、正态性检验图、事后检验图
- 💾 **导出功能**: 一键导出完整Excel报告
- 🚀 **无需依赖特定环境**: 提供EXE版本，可直接使用

## 快速开始

### 方式一：直接运行EXE（无需安装Python，约645MB）

1. 下载 `SPM1D分析软件.exe`
2. 双击即可运行

### 方式二：从源码运行（轻量化，约150KB）

```bash
# 克隆或下载本项目
git clone <https://github.com/shanshanfagu/SPM1D-Analysis-Wrapper-Program>

# 安装依赖
pip install -r requirements.txt

# 运行程序
python main_window.py
```

## 使用流程

```
数据导入 → 正态性检验 → 参数设置 → 运行分析 → 事后检验 → 查看图表 → 导出数据
```

### 数据导入

支持Excel (.xlsx) 和 CSV 格式：
- 单文件：包含所有组别的数据
- 多文件：按文件夹/工作表分组

### 正态性检验

- 自动执行D'Agostino K²检验
- 显示各组检验结果
- 可选择检验方法（参数/非参数）

### 参数设置

| 分析类型 | 说明 |
|---------|------|
| 单样本t检验 | 与标准曲线比较 |
| 两样本t检验 | 两组独立样本或配对样本比较 |
| 单因素ANOVA | 多组样本比较 |
| 简单回归 | 单变量趋势分析 |

### 数据导出

一键导出完整Excel报告（.xlsx）

| Sheet | 内容 |
|-------|------|
| 总报告 | 分析参数摘要 |
| 主效应检验结果 | SPM曲线数值 |
| 正态分布结果 | K²曲线数值 |
| 事后检验结果 | 两两比较曲线 |

## 数据格式要求

### Excel文件格式

| 样本\时间点 | T1 | T2 | T3 | T4 | ... |
|------------|-----|-----|-----|-----|-----|
| Subject1 | 1.2 | 1.3 | 1.4 | 1.5 | ... |
| Subject2 | 1.1 | 1.2 | 1.3 | 1.4 | ... |
| Subject3 | 1.3 | 1.4 | 1.5 | 1.6 | ... |

- 每列代表一个时间点
- 每行代表一个样本
- 数值为数值类型

## 依赖包

- PyQt5>=5.15.0
- spm1d>=0.4.5
- numpy>=1.20
- pandas>=1.3
- matplotlib>=3.5
- scipy>=1.7
- openpyxl>=3.0

## 许可证

GPL-3.0 License

## 参考项目

- [spm1d项目](https://github.com/0todd0000/spm1d)
- [spm1d文档](http://spm1d.org)
